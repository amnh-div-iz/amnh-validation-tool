{"version":3,"sources":["amnh-validation-tool/static/js/errors.js","amnh-validation-tool/static/js/css_injector.js","amnh-validation-tool/static/js/worms.js"],"names":["errors","introIvalidUsername","longFormNoUserName","addPersonNoVerbatim","noPlacesFound","googleMapsError","noTaxnomoniesFound","htmlTextToElement","template","document","createElement","html","trim","innerHTML","content","firstChild","showError","elementId","text","center","centerClass","errorTemplate","nameInput","getElementById","insertAdjacentElement","classList","add","cleanErrors","labelId","inputId","errorLabel","remove","addStyleString","parentId","rule","parent","node","appendChild","addPlaceHolderBorders","formId","button","addEventListener","getSearchInfo","getFormInfo","elSpecies","elGenus","species","value","genus","getWorms","cleanFields","fields","querySelectorAll","i","length","searchBox","split","spinner","url","fetch","then","response","json","displayResponse","catch","console","error","updateiFrameDisplay","map","prop","item","field","iframe","src"],"mappings":"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","file":"worms.fd9e0e9c.map","sourcesContent":["const errors = {\n  introIvalidUsername: \"Remember to fill in a valid username\",\n  longFormNoUserName: \"You have to enter your Name before entering data\",\n  addPersonNoVerbatim: \"You must enter a Verbatim Name before adding a Person\",\n  noPlacesFound: \"No details about the place you searched for\",\n  googleMapsError: \"Error Status in Google Maps search: \",\n  noTaxnomoniesFound:\n    \"Worms couldn't find that taxonomy, try searching it by hand \"\n};\n\n/**\n * Converts a valid html string representation into an html element\n * @param {html string representation} html\n */\nconst htmlTextToElement = html => {\n  const template = document.createElement(\"template\");\n  html = html.trim();\n  template.innerHTML = html;\n  return template.content.firstChild;\n};\n\n/**\n * Displays an error message and adds the error class to the input field\n */\nexport const showError = (elementId, text, center=true) => {\n  var centerClass = center ? 'u-align-center' : ''\n  const errorTemplate = `<div id=\"Error\" class='c-form__error-label ${centerClass}' >${text}</div>`;\n  const nameInput = document.getElementById(elementId);\n\n  nameInput.insertAdjacentElement(\"afterend\", htmlTextToElement(errorTemplate));\n  nameInput.classList.add(\"c-input--error\");\n};\n\n/**\n * Removes the error classes and html elements\n */\nexport const cleanErrors = (labelId, inputId) => {\n  const errorLabel = document.getElementById(labelId);\n  const nameInput = document.getElementById(inputId);\n\n  if (errorLabel) {\n    errorLabel.remove();\n    nameInput.classList.remove(\"c-input--error\");\n  }\n};\n\nexport default errors;\n","/**\n * Adds a style element with the given rule as a child of the given parent element\n * @param {parentId string}\n * @param {rule string}\n */\nexport const addStyleString = (parentId, rule) => {\n  var parent = document.getElementById(parentId);\n  var node = document.createElement(\"style\");\n  node.innerHTML = rule;\n  parent.appendChild(node);\n};\n\n/**\n * Gives a border to all the input fields of the given form\n * @param {formId string}\n */\nexport const addPlaceHolderBorders = (formId) => {\n  addStyleString(formId, `#${formId} input:placeholder-shown {\n                    border: 3px solid #ffa500 !important;\n                  }`\n  );\n}","import errors from \"./errors\";\nimport { showError, cleanErrors } from \"./errors\";\nimport { addPlaceHolderBorders } from \"./css_injector\";\n\nconst button = document.getElementById(\"worms\");\nbutton.addEventListener(\"click\", getSearchInfo);\n\nfunction getFormInfo() {\n  const elSpecies = document.getElementById(\"species\");\n  const elGenus = document.getElementById(\"genus\");\n  const species = elSpecies.value;\n  const genus = elGenus.value;\n  getWorms(genus, species);\n  document.getElementById(\"loading-state\").classList.add(\"active\");\n}\n\nfunction cleanFields() {\n  const fields = document.querySelectorAll(\n    \"#taxForm input:not([type='search'])\"\n  );\n  for (let i = 0; i < fields.length; i++) {\n    fields[i].value = \"\";\n  }\n}\n\nfunction getSearchInfo() {\n  const searchBox = document.getElementById(\"taxonomy-search\").value.split(\" \");\n\n  const genus = searchBox[0];\n  const species = searchBox[1];\n  const spinner = document.getElementById(\"whales-spinner\");\n  spinner.classList.remove(\"u-hidden\");\n  document.getElementById(\"taxForm\").classList.add(\"u-hidden\");\n  getWorms(genus, species);\n}\n\nfunction getWorms(genus, species) {\n  const url = species\n    ? `http://www.marinespecies.org/rest/AphiaRecordsByMatchNames?scientificnames%5B%5D=${genus}%20${species}&marine_only=true`\n    : `http://www.marinespecies.org/rest/AphiaRecordsByMatchNames?scientificnames%5B%5D=${genus}&marine_only=true`;\n\n  cleanErrors(\"Error\", \"searchTaxContainer\");\n  cleanFields();\n  fetch(url)\n    .then(response => {\n      document.getElementById(\"whales-spinner\").classList.add(\"u-hidden\");\n      document.getElementById(\"taxForm\").classList.remove(\"u-hidden\");\n      return response.json();\n    })\n    .then(json => {\n      displayResponse(json);\n      addPlaceHolderBorders(\"taxonomy-data\");\n    })\n    .catch(error => {\n      // when there aren't results,it just returns an empty response\n      // and triggers an error\n      console.error(error);\n\n      // clean just inc ase, there was a double error issue # 88\n      cleanErrors(\"Error\", \"searchTaxContainer\");\n      showError(\"searchTaxContainer\", errors.noTaxnomoniesFound, false);\n      updateiFrameDisplay(\"http://www.marinespecies.org/aphia.php?p=search\");\n    });\n}\n\nfunction displayResponse(response) {\n  response[0].map(item => {\n    for (const prop in item) {\n      // if form field exists, fill in with data from API\n      const field = document.getElementById(prop);\n      if (field) {\n        field.value = item[prop];\n        field.classList.add(\"dynamic\");\n      }\n      if (prop == \"url\") {\n        updateiFrameDisplay(item[prop]);\n      }\n    }\n  });\n}\n\nfunction updateiFrameDisplay(url) {\n  const iframe = document.getElementById(\"worms-iframe\");\n  iframe.src = url;\n}\n"]}